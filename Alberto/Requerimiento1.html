<!--
Requerimiento 1

Se pide hacer una aplicación AJAX que gestione una pizzería como la actividad 1. 
Puedes basarte en dicha actividad para reutilizar lo que consideres o para hacerte 
una idea de lo que tienes que implementar junto a tu compañero. El formulario que 
tendremos que usar será el mismo que en dicha actividad, consúltala para más información.

La idea es simular un entorno de acceso a servidor para traer toda la información 
que se necesite para cargar la página. La página cargará parte de los datos de manera 
dinámica, concretamente los tamaños y los ingredientes. Dichos datos estarán en formato JSON, 
por lo que habrá que tratarlos en el cliente para poder mostrarlos.

Nada más terminar de cargar la página, se accederá mediante AJAX a datos en un fichero 
del servidor para traer los tamaños de las pizzas y cargarlos dinámicamente. Al mismo tiempo, 
nos traeremos los ingredientes que tenemos disponibles para mostrarlos en nuestra pizzería.

También dispondremos de un botón de refrescar, de tal manera que cuando lo pulsemos haremos 
una llamada de nuevo a nuestro servidor para traernos los posibles cambios de los datos de 
nuestra aplicación.

Requerimiento 2

Si pulsamos el botón de procesar el pedido, la web mostrará el resultado del precio total de 
la pizza. Para calcular dicho precio, el programa accederá mediante AJAX al servidor para traer 
la información sobre el precio del tamaño de la pizza escogido, así como el precio de los 
ingredientes escogidos. El precio de los ingredientes podrá ser diferente.
-->

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedido de pizza</title>
    <link rel="stylesheet" href="css/styles.css">

</head>

<script type="application/javascript">

    const URL_DESTINO = "http://localhost:5500/Alberto/Requerimiento1.html"
    const RECURSO = "tamanios_ingredientes.json"

    function enviarpeticionAjax() {
        let xmlHttp = new XMLHttpRequest()
        xmlHttp.open('GET', URL_DESTINO + RECURSO, true)//Asincrono
        xmlHttp.send() //podemos poner null o no, es lo mismo

        //esta funcion de callback se ejecutara cuando se haya procesado la respueta HTTP
        xmlHttp.onload = function () {
            procesarRespuesta(this.responseText)
        }

        xmlHttp.onerror = function () {
            alert("No se pueden cargar los datos!")
        }

    }

    function procesarRespuesta(jsonDoc) {
        //Convertimos un texto a un objeto JSON
        var objetoJson = JSON.parse(jsonDoc)

        console.log(objetoJson)

        var table = "<tr><th>Tamanio</th></tr>";
        var arraytamanios = objetoJson.TAMANIOS;
        var arrayingredientes = objetoJson.INGREDIENTES;


        // Mostrar tamaños de pizza como botones de radio
        var conTam = document.getElementById("tamanios");
        var tamDiv = document.createElement("div");
        tamDiv.innerHTML = "Elige un tamaño de pizza <br/>";

        for (let i = 0; i < arrayTam.length; i++) {
            var radioB = document.createElement("input");
            radioB.type = "radio";
            radioB.name = "tamañoPizza";
            radioB.id = arrayTam[i].nombre;
            radioB.value = arrayTam[i].nombre;

            var radioL = document.createElement("label");
            radioL.textContent = arrayTam[i].nombre;

            tamDiv.appendChild(radioB);
            tamDiv.appendChild(radioL);
        }

        conTam.appendChild(tamDiv);

    }
</script>

<body>
    <img src="img/image4.jpg" alt="" class="img">
    <form name="formulario" id="formulario">
        <legend>
            <h1>Formulario de pedido de pizza:</h1>
        </legend>

        <table id="resultadoBusqueda">
            <tr>
                <td>Nombre</td>
                <td><input type="text" name="nombre" id="nombre" class="text" title="Escribe quí tu nombre" autofocus />
                </td>
            </tr>
            <tr>
                <td>Apellidos</td>
                <td><input type="text" name="apellidos" id="apellidos" class="text"
                        title="Escribe aquí tus apellidos" /></td>
            </tr>
            <tr>
                <td>Dirección</td>
                <td><input type="text" name="direccion" id="direccion" class="text" title="Escribe aquí tu dirección" />
                </td>
            </tr>
            <tr>
                <td>Teléfono</td>
                <td><input type="text" name="telefono" id="telefono" class="text"
                        title="Escribe aquí tu número de móvil" /></td>
            </tr>
            <tr>
                <td>Email</td>
                <td><input type="text" name="email" id="email" class="text" title="Escribe aquí tu email" /></td>
            </tr>
        </table><br />

        <!-- Botones para radio
        <label><b>Selecciona el tamaño de la pizza:</b></label><br />
        <label class="flexbox">pequeña</label>
        <input type="radio" name="tamanio" id="tamanio" value="pequenia"/>
        <label class="flexbox">mediana</label>
        <input type="radio" name="tamanio" id="tamanio" value="mediana"/>
        <label class="flexbox">grande</label>
        <input type="radio" name="tamanio" id="tamanio" value="grande"/><br /><br />
        -->
        <!--Checkbox
        <label class="label"><b>Selecciona los ingredientes adicionales:</b></label><br />
        <label class="flexbox">jamon</label>
        <input type="checkbox" name="ingrediente" id="ingrediente" value="jamon" />
        <label class="flexbox">mozzarella</label>
        <input type="checkbox" name="ingrediente" id="ingrediente" value="mozzarella" />
        <label class="flexbox">anchoas</label>
        <input type="checkbox" name="ingrediente" id="ingrediente" value="anchoas" />
        <label class="flexbox">pepperoni</label>
        <input type="checkbox" name="ingrediente" id="ingrediente" value="pepperoni" /><br /><br />
        -->
        <!-- 
        <input type="button" id="procesar" value="Pocesar Pedido" class="pedido">

        <img src="img/image3.jpg" alt="" class="img">
        -->

        <div id="tamanios"></div><br />
        <div id="ingredientes"></div><br />
    </form>



    <button id="btnBuscarAsincrono" onclick="enviarPeticionAjax()">Refrescar</button>

</body>

</html>